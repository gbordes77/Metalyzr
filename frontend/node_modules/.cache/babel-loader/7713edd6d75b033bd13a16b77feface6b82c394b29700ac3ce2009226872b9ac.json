{"ast":null,"code":"import React,{useState}from'react';import{useTournaments,useArchetypes,useFormats}from'../../hooks/useApi';import{TournamentCard}from'../../components/TournamentCard';import{MetagameChart}from'../../components/MetagameChart';import{LoadingSpinner}from'../../components/ui/LoadingSpinner';import{ErrorMessage}from'../../components/ui/ErrorMessage';import{Card}from'../../components/ui/Card';import{Filter,BarChart3,PieChart,TrendingUp}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PublicDashboard=()=>{const[selectedFormat,setSelectedFormat]=useState('');const[chartType,setChartType]=useState('pie');const{data:tournaments,loading:tournamentsLoading,error:tournamentsError}=useTournaments({format:selectedFormat||undefined,limit:6});const{data:archetypes,loading:archetypesLoading,error:archetypesError}=useArchetypes({format:selectedFormat||undefined});const{data:formats,loading:formatsLoading}=useFormats();// Préparer les données du métagame pour le graphique\nconst metagameData=(archetypes===null||archetypes===void 0?void 0:archetypes.map(archetype=>({archetype:archetype.name,category:archetype.category,deck_count:archetype.deck_count,meta_share:archetypes.length>0?archetype.deck_count/archetypes.reduce((sum,a)=>sum+a.deck_count,0)*100:0,avg_wins:0,// Pas disponible dans cette vue\nbest_position:null})).filter(entry=>entry.deck_count>0))||[];return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-sm border-b\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4 py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row md:items-center md:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"Metalyzr\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Analyse du m\\xE9tagame Magic: The Gathering\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 md:mt-0 flex items-center space-x-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Filter,{className:\"h-4 w-4 text-gray-500\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedFormat,onChange:e=>setSelectedFormat(e.target.value),className:\"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\",disabled:formatsLoading,\"aria-label\":\"S\\xE9lectionner un format\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous les formats\"}),formats===null||formats===void 0?void 0:formats.map(format=>/*#__PURE__*/_jsx(\"option\",{value:format,children:format},format))]})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"h-8 w-8 text-blue-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Tournois analys\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:(tournaments===null||tournaments===void 0?void 0:tournaments.length)||0})]})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"h-8 w-8 text-green-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Arch\\xE9types actifs\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:(archetypes===null||archetypes===void 0?void 0:archetypes.filter(a=>a.deck_count>0).length)||0})]})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(PieChart,{className:\"h-8 w-8 text-purple-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Decks analys\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:(archetypes===null||archetypes===void 0?void 0:archetypes.reduce((sum,a)=>sum+a.deck_count,0))||0})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsx(Card,{title:\"R\\xE9partition du M\\xE9tagame\",subtitle:selectedFormat?`Format: ${selectedFormat}`:'Tous formats confondus',children:archetypesLoading?/*#__PURE__*/_jsx(LoadingSpinner,{className:\"h-64\"}):archetypesError?/*#__PURE__*/_jsx(ErrorMessage,{message:archetypesError}):metagameData.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex rounded-md shadow-sm\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setChartType('pie'),className:`px-3 py-2 text-sm font-medium rounded-l-md border ${chartType==='pie'?'bg-blue-50 text-blue-700 border-blue-200':'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`,\"aria-label\":\"Graphique en secteurs\",title:\"Graphique en secteurs\",children:/*#__PURE__*/_jsx(PieChart,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setChartType('bar'),className:`px-3 py-2 text-sm font-medium rounded-r-md border-t border-r border-b ${chartType==='bar'?'bg-blue-50 text-blue-700 border-blue-200':'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`,\"aria-label\":\"Graphique en barres\",title:\"Graphique en barres\",children:/*#__PURE__*/_jsx(BarChart3,{className:\"h-4 w-4\"})})]})}),/*#__PURE__*/_jsx(MetagameChart,{data:metagameData,type:chartType})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Aucune donn\\xE9e de m\\xE9tagame disponible\"})})}),/*#__PURE__*/_jsx(Card,{title:\"Tournois R\\xE9cents\",subtitle:\"Derniers tournois analys\\xE9s\",children:tournamentsLoading?/*#__PURE__*/_jsx(LoadingSpinner,{className:\"h-64\"}):tournamentsError?/*#__PURE__*/_jsx(ErrorMessage,{message:tournamentsError}):tournaments&&tournaments.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 max-h-96 overflow-y-auto\",children:tournaments.map(tournament=>/*#__PURE__*/_jsx(TournamentCard,{tournament:tournament,className:\"hover:bg-gray-50\"},tournament.id))}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Aucun tournoi trouv\\xE9\"})})})]}),archetypes&&archetypes.length>0&&/*#__PURE__*/_jsx(Card,{title:\"Arch\\xE9types Populaires\",subtitle:\"Arch\\xE9types les plus jou\\xE9s\",className:\"mt-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:archetypes.filter(archetype=>archetype.deck_count>0).sort((a,b)=>b.deck_count-a.deck_count).slice(0,6).map(archetype=>/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:archetype.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[archetype.deck_count,\" decks\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:archetype.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded\",children:archetype.category}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:archetype.color_identity||'Incolore'})]})]},archetype.id))})})]})]});};export default PublicDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}