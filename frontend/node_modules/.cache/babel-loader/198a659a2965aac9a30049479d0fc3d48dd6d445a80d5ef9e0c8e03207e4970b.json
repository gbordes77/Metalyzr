{"ast":null,"code":"import React,{useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{useTournament,useTournamentMetagame,useTournamentDecks}from'../../hooks/useApi';import{MetagameChart}from'../../components/MetagameChart';import{LoadingSpinner}from'../../components/ui/LoadingSpinner';import{ErrorMessage}from'../../components/ui/ErrorMessage';import{Card}from'../../components/ui/Card';import{ArrowLeft,Calendar,MapPin,Users,Trophy,Filter,Medal}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TournamentDetails=()=>{const{id}=useParams();const navigate=useNavigate();const tournamentId=id?parseInt(id):0;const[selectedArchetype,setSelectedArchetype]=useState('');const[chartType,setChartType]=useState('pie');const{data:tournament,loading:tournamentLoading,error:tournamentError}=useTournament(tournamentId);const{data:metagame,loading:metagameLoading,error:metagameError}=useTournamentMetagame(tournamentId);const{data:decks,loading:decksLoading,error:decksError}=useTournamentDecks(tournamentId,{archetype:selectedArchetype||undefined,limit:20});const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('fr-FR',{year:'numeric',month:'long',day:'numeric'});};const getPositionColor=position=>{if(!position)return'bg-gray-100 text-gray-700';if(position===1)return'bg-yellow-100 text-yellow-800';if(position<=4)return'bg-orange-100 text-orange-800';if(position<=8)return'bg-blue-100 text-blue-800';return'bg-gray-100 text-gray-700';};if(tournamentLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"lg\"})});}if(tournamentError||!tournament){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(ErrorMessage,{message:tournamentError||'Tournoi non trouvé',onRetry:()=>navigate('/tournaments')})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-sm border-b\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate(-1),className:\"flex items-center text-gray-600 hover:text-gray-900 mr-4\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-5 w-5 mr-1\"}),\"Retour\"]}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:tournament.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"h-4 w-4 mr-2\"}),formatDate(tournament.date)]}),tournament.location&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"h-4 w-4 mr-2\"}),tournament.location]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Users,{className:\"h-4 w-4 mr-2\"}),tournament.total_players,\" joueurs\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(Trophy,{className:\"h-4 w-4 mr-2\"}),tournament.rounds,\" rondes\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Format\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:tournament.format})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Organisateur\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gray-900\",children:tournament.organizer})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Decks analys\\xE9s\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:tournament.decks_count})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Statut\"}),/*#__PURE__*/_jsx(\"span\",{className:`inline-block px-2 py-1 rounded-full text-sm font-medium ${tournament.is_complete?'bg-green-100 text-green-800':'bg-orange-100 text-orange-800'}`,children:tournament.is_complete?'Terminé':'En cours'})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsx(Card,{title:\"M\\xE9tagame du Tournoi\",subtitle:`Répartition des ${(metagame===null||metagame===void 0?void 0:metagame.total_decks)||0} decks`,children:metagameLoading?/*#__PURE__*/_jsx(LoadingSpinner,{className:\"h-64\"}):metagameError?/*#__PURE__*/_jsx(ErrorMessage,{message:metagameError}):metagame&&metagame.metagame.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex rounded-md shadow-sm\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setChartType('pie'),className:`px-3 py-2 text-sm font-medium rounded-l-md border ${chartType==='pie'?'bg-blue-50 text-blue-700 border-blue-200':'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`,\"aria-label\":\"Graphique en secteurs\",title:\"Graphique en secteurs\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setChartType('bar'),className:`px-3 py-2 text-sm font-medium rounded-r-md border-t border-r border-b ${chartType==='bar'?'bg-blue-50 text-blue-700 border-blue-200':'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`,\"aria-label\":\"Graphique en barres\",title:\"Graphique en barres\",children:\"\\uD83D\\uDCC8\"})]})}),/*#__PURE__*/_jsx(MetagameChart,{data:metagame.metagame,type:chartType})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Aucune donn\\xE9e de m\\xE9tagame disponible\"})})}),/*#__PURE__*/_jsxs(Card,{title:\"Decks du Tournoi\",subtitle:\"Performances des joueurs\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Filter,{className:\"h-4 w-4 text-gray-500\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedArchetype,onChange:e=>setSelectedArchetype(e.target.value),className:\"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\",\"aria-label\":\"Filtrer par arch\\xE9type\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tous les arch\\xE9types\"}),metagame===null||metagame===void 0?void 0:metagame.metagame.map(entry=>/*#__PURE__*/_jsx(\"option\",{value:entry.archetype,children:entry.archetype},entry.archetype))]})]})}),decksLoading?/*#__PURE__*/_jsx(LoadingSpinner,{className:\"h-64\"}):decksError?/*#__PURE__*/_jsx(ErrorMessage,{message:decksError}):decks&&decks.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 max-h-96 overflow-y-auto\",children:decks.map(deck=>/*#__PURE__*/_jsxs(\"div\",{className:\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-900\",children:deck.player_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:deck.archetype})]}),deck.position&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Medal,{className:\"h-4 w-4 mr-1 text-gray-500\"}),/*#__PURE__*/_jsxs(\"span\",{className:`px-2 py-1 rounded-full text-xs font-medium ${getPositionColor(deck.position)}`,children:[deck.position,\"e\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600\",children:[deck.wins,\"V\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-600\",children:[deck.losses,\"D\"]}),deck.draws>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600\",children:[deck.draws,\"N\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-500\",children:[deck.total_cards,\" cartes\"]})]})]},deck.id))}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Aucun deck trouv\\xE9\"})})]})]}),metagame&&metagame.metagame.length>0&&/*#__PURE__*/_jsx(Card,{title:\"Analyse des Arch\\xE9types\",subtitle:\"Performance d\\xE9taill\\xE9e par arch\\xE9type\",className:\"mt-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Arch\\xE9type\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Cat\\xE9gorie\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-right py-3 px-4 font-medium text-gray-900\",children:\"Decks\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-right py-3 px-4 font-medium text-gray-900\",children:\"Part de m\\xE9ta\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-right py-3 px-4 font-medium text-gray-900\",children:\"Victoires moy.\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-right py-3 px-4 font-medium text-gray-900\",children:\"Meilleure place\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:metagame.metagame.sort((a,b)=>b.meta_share-a.meta_share).map(entry=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-100 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 font-medium text-gray-900\",children:entry.archetype}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-gray-600\",children:entry.category}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-right text-gray-900\",children:entry.deck_count}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-right text-gray-900\",children:[entry.meta_share.toFixed(1),\"%\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-right text-gray-900\",children:entry.avg_wins.toFixed(1)}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-right\",children:entry.best_position?/*#__PURE__*/_jsxs(\"span\",{className:`px-2 py-1 rounded-full text-xs font-medium ${getPositionColor(entry.best_position)}`,children:[entry.best_position,\"e\"]}):/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:\"-\"})})]},entry.archetype))})]})})})]})]});};export default TournamentDetails;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}